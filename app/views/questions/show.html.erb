<%= link_to "Volver", :back , :class => "btn btn-inverse" %>
<%= link_to "Hacer una pregunta", new_question_path , :class => "btn btn-inverse" %><br><br>

<div class="well row span10">

	<h1><%= @question.title %></h1>
	<p>
		<%= @question.text %>
	</p>
	  Hace <%= time_ago_in_words @question.created_at %>
	  por <%= link_to @question.user.username, @question.user %>
	<p>
	<% if current_user.id == @question.user_id %>
		<%= link_to 'Edit', edit_question_path(@question) %> |
		<%= link_to 'Delete', @question, :method => :delete, :confirm => "Esta seguro?" %> |
	<% end %>
	</p>
	<div class = "span7 offset1">
		<h6><%= pluralize(@question.qcomments.count, 'Comentario' , 'Comentarios' )%> </h6>
		<div class="text-right">
		<% @question.qcomments.each do |qcomment| %>
				<hr size="5px" height="1px" color="silver">
			  	<p><small><%= link_to qcomment.user.username, qcomment.user %>:
				<%= qcomment.text %>
				<br>Hace <%= time_ago_in_words qcomment.created_at %> 
			  	<% if current_user.id == qcomment.user_id %>
				<%= link_to 'Eliminar comentario', [@question, qcomment], :method => :delete, :confirm => "Esta seguro?" %>
				</small></p>
			<% end %>
		<% end %>
		</div>
		<%= link_to_function "Comentar", "$('#coment1').toggle()" %>
		<div id="coment1" class="row text-center" style="display:none;">
			<%= simple_form_for [@question, @question.qcomments.build], :id => "form1" do |f| %>
			  <%= f.error_notification %>

			    <%= f.text_area :text, :size => '30x1'%><br>
			    <%= f.hidden_field :user_id, :value => current_user.id %>
			    <%= f.hidden_field :question_id, :value => @question.id %>
			    <%= f.button :submit, "Comentar pregunta"%>
			<% end %>
		</div >
	</div>
	<div class = "well span9">
	<h6><%=  pluralize(@question.answers.count, 'Respuesta', 'Respuestas') %></h6>
	<% @question.answers.each do |answer| %>
	  	
		<hr size="5px" color="silver">
		<h3><%= answer.text %></h3>
		<p>
			<br>Hace <%= time_ago_in_words answer.created_at %> por <%= link_to answer.user.username, answer.user %> 
	  		<% if current_user.id == answer.user_id %>
			<%= link_to 'Eliminar respuesta', [@question, answer], :method => :delete, :confirm => "Esta seguro?" %>
			<% end %>
		</p>
		<div class="span7 offset1">
		<h6><%= pluralize(answer.acomments.count, 'Comentario' , 'Comentarios' )%> </h6>
		<div class="text-right">
		<% answer.acomments.each do |acomment| %>
		<hr size="5px" color="silver">
		  	<p><%= link_to acomment.user.username, acomment.user %>:
			<%= acomment.text %>
			<br>Hace <%= time_ago_in_words acomment.created_at %> 
		  	<% if current_user.id == acomment.user_id %>
			<%= link_to 'Eliminar comentario', [@question, acomment], :method => :delete, :confirm => "Esta seguro?" %>
			</p>
			<% end %>
		<% end %>
		</div>
		</div>
		<%= link_to_function "Comentar", "$('#coment2').toggle()" %>
		<div id:"coment2" class="row text-center" style="display:none;">
		<%= simple_form_for [@question, @question.acomments.build] do |af| %>
		  <%= af.error_notification %>

		    <%= af.text_area :text, :size => '30x1'%><br>
		    <%= af.hidden_field :user_id, :value => current_user.id %>
		    <%= af.hidden_field :answer_id, :value => answer.id %>
		    <%= af.button :submit, "Comentar respuesta"%>
		<% end %>
		</div>

	<% end %>
		<hr size="5px" color="silver">
		<%= link_to_function "Hacer una respuesta", "$('#respuesta').toggle()" %>
		<div id="respuesta" class="row text-center" style="display:none;">
			<%= simple_form_for [@question, @question.answers.build] do |f| %>
			  <%= f.error_notification %>

			    <%= f.text_area :text, :size => '30x2'%><br>
			    <%= f.hidden_field :user_id, :value => current_user.id %>
			    <%= f.hidden_field :question_id, :value => @question.id %>
			    <%= f.button :submit, "Publicar respuesta"%>
			<% end %>
		</div>
	</div>
</div>
<script>
$(document).ready(function() {

 $('#coment1').hide(); //Initially form wil be hidden.
</script>